(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))i(t);new MutationObserver(t=>{for(const s of t)if(s.type==="childList")for(const d of s.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&i(d)}).observe(document,{childList:!0,subtree:!0});function c(t){const s={};return t.integrity&&(s.integrity=t.integrity),t.referrerPolicy&&(s.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?s.credentials="include":t.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(t){if(t.ep)return;t.ep=!0;const s=c(t);fetch(t.href,s)}})();let m=$(window).height(),y=$(window).width(),o={},f=[],u=[],n=document.querySelector("#game-board"),a=n.getContext("2d");n.width=y;n.height=m;$(window).on("load",function(){$("#game-start").modal("show")});$(".name-form").submit(e=>{e.preventDefault(),o.name=document.querySelector("#name-input").value,$("#game-start").modal("hide"),$(".modal").modal("hide"),$(".hiddenOnStart").removeAttr("hidden"),x()});function h(){O(),g(),p(),w(),b(),S(),requestAnimationFrame(h)}function g(){a.clearRect(0,0,n.width,n.height)}function p(){const e=-o.locX+n.width/2,r=-o.locY+n.height/2;a.translate(e,r)}function w(){a.beginPath(),a.fillStyle=o.color,a.arc(o.locX,o.locY,o.radius,0,Math.PI*2),a.fill(),a.lineWidth=3,a.strokeStyle="rgb(0,255,0)",a.stroke()}function b(){f.filter(e=>e.uid!==o.uid).forEach(e=>{a.beginPath(),a.fillStyle=e.color,a.arc(e.locX,e.locY,e.radius,0,Math.PI*2),a.fill(),a.lineWidth=3,a.strokeStyle="rgb(0,255,0)",a.stroke()})}function S(){u.forEach(e=>{a.beginPath(),a.fillStyle=e.color,a.arc(e.locX,e.locY,e.radius,0,Math.PI*2),a.fill()})}function P(){$(".player-score").text(o.score||0)}function M(){$(".leader-board").empty(),f.sort((e,r)=>r.score-e.score).forEach(e=>{const r=$('<li class="leaderboard-player">').text(`${e.playerName}: ${e.score}`);$(".leader-board").append(r)})}function O(){a.setTransform(1,0,0,1,0,0)}n.addEventListener("mousemove",e=>{const r={x:e.clientX,y:e.clientY};let c,i;const t=Math.atan2(r.y-n.height/2,r.x-n.width/2)*180/Math.PI;t>=0&&t<90?(c=1-t/90,i=-(t/90)):t>=90&&t<=180?(c=-(t-90)/90,i=-(1-(t-90)/90)):t>=-180&&t<-90?(c=(t+90)/90,i=1+(t+90)/90):t<0&&t>=-90&&(c=(t+90)/90,i=1-(t+90)/90),o.xVector=c,o.yVector=i});const l=new WebSocket("ws://5.135.186.53:8090");function x(){h();const e=I();o={...o,sid:e},l.send(JSON.stringify({_type:"InitMessage",data:{playerName:o.name,sid:e}}))}function I(){return Date.now().toString(36)+Math.random().toString(36).substring(2)}l.addEventListener("message",e=>{const r=JSON.parse(e.data);switch(r&&r._type){case"InitMessageResponse":u=r.data.orbs,o.sid===r.data.playerData.sid&&(o={...o,...r.data.playerData},setInterval(()=>{l.readyState===WebSocket.OPEN&&o.uid&&o.xVector&&l.send(JSON.stringify({_type:"TickMessage",data:{uid:o.uid,xVector:o.xVector||0,yVector:o.yVector||0}}))},33));break;case"PlayerListMessageResponse":f=r.data,M();break;case"TickMessageResponse":o.sid===r.data.playerData.sid&&(o={...o,...r.data.playerData},u=r.data.orbs,P());break}});l.onclose=function(e){console.log("WebSocket closed with code:",e.code),console.log("Reason:",e.reason)};
