(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))s(t);new MutationObserver(t=>{for(const n of t)if(n.type==="childList")for(const d of n.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&s(d)}).observe(document,{childList:!0,subtree:!0});function c(t){const n={};return t.integrity&&(n.integrity=t.integrity),t.referrerPolicy&&(n.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?n.credentials="include":t.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(t){if(t.ep)return;t.ep=!0;const n=c(t);fetch(t.href,n)}})();let y=$(window).height(),g=$(window).width(),o={},f=[],u=[],i=document.querySelector("#game-board"),a=i.getContext("2d");i.width=g;i.height=y;const h=["#171717","#2E2E2E","#454545","#5C5C5C","#737373","#8A8A8A","#5B7586","#8CA2B0","#36454F","#BF181D","#ED7377","#B35F00","#000080","#38B261","#96DEAE","#E3AE09","#FADB7C","#635345","#BEAEA1","#362624","#212121","#383838","#B7D100","#E5FF2E","#168900","#ADFF9E","#D100D1","#999999","#6B6B6B","#DEDEDE","#B0B0B0","#E4AD58","#DD9A30","#F1D4A7","#483C32","#AB9786","#7E6958","#B75CFF","#A32EFF","#5C6380","#DCDEE6","#8C8C8C","#A52217","#EE8D85","#EAE000","#BCB400","#FFFDD0","#E0B0FF","#D40032","#FF8DA7","#ED4002","#197D4B","#93E9BE","#024376"];i.style.backgroundColor=h[Math.floor(Math.random()*h.length)];$(window).on("load",function(){$("#game-start").modal("show")});$(".name-form").submit(e=>{e.preventDefault(),o.name=document.querySelector("#name-input").value,$("#game-start").modal("hide"),$(".modal").modal("hide"),$(".hiddenOnStart").removeAttr("hidden"),S()});$("#play-again").click(e=>{e.preventDefault(),window.location.reload()});function m(){A(),p(),E(),D(),w(),b(),requestAnimationFrame(m)}function p(){a.clearRect(0,0,i.width,i.height)}function E(){const e=-o.locX+i.width/2,r=-o.locY+i.height/2;a.translate(e,r)}function D(){a.beginPath(),a.fillStyle=o.color,a.arc(o.locX,o.locY,o.radius,0,Math.PI*2),a.fill(),a.lineWidth=3,a.strokeStyle="rgb(0,255,0)",a.stroke()}function w(){f.filter(e=>e.uid!==o.uid).forEach(e=>{a.beginPath(),a.fillStyle=e.color,a.arc(e.locX,e.locY,e.radius,0,Math.PI*2),a.fill(),a.lineWidth=3,a.strokeStyle="rgb(0,255,0)",a.stroke()})}function b(){u.forEach(e=>{a.beginPath(),a.fillStyle=e.color,a.arc(e.locX,e.locY,e.radius,0,Math.PI*2),a.fill()})}function B(){$(".player-score").text(o.score||0)}function F(){$(".leader-board").empty(),f.sort((e,r)=>r.score-e.score).forEach(e=>{const r=$('<li class="leaderboard-player">').text(`${e.playerName}: ${e.score}`);$(".leader-board").append(r)})}function A(){a.setTransform(1,0,0,1,0,0)}i.addEventListener("mousemove",e=>{const r={x:e.clientX,y:e.clientY};let c,s;const t=Math.atan2(r.y-i.height/2,r.x-i.width/2)*180/Math.PI;t>=0&&t<90?(c=1-t/90,s=-(t/90)):t>=90&&t<=180?(c=-(t-90)/90,s=-(1-(t-90)/90)):t>=-180&&t<-90?(c=(t+90)/90,s=1+(t+90)/90):t<0&&t>=-90&&(c=(t+90)/90,s=1-(t+90)/90),o.xVector=c,o.yVector=s});const l=new WebSocket("ws://5.135.186.53:8090/ws");function S(){m();const e=C();o={...o,sid:e},l.send(JSON.stringify({_type:"InitMessage",data:{playerName:o.name,sid:e}}))}function C(){return Date.now().toString(36)+Math.random().toString(36).substring(2)}l.addEventListener("message",e=>{const r=JSON.parse(e.data);switch(r&&r._type){case"InitMessageResponse":u=r.data.orbs,o.sid===r.data.playerData.sid&&(o={...o,...r.data.playerData},setInterval(()=>{l.readyState===WebSocket.OPEN&&o.uid&&o.xVector&&l.send(JSON.stringify({_type:"TickMessage",data:{uid:o.uid,xVector:o.xVector||0,yVector:o.yVector||0}}))},33));break;case"PlayerListMessageResponse":f=r.data,F();break;case"TickMessageResponse":o.sid===r.data.playerData.sid&&(o={...o,...r.data.playerData},u=r.data.orbs,B());break}});l.onclose=function(e){console.log("WebSocket closed with code:",e.code),console.log("Reason:",e.reason),o.sid&&($("#game-start").modal("hide"),$("#game-over").modal("show"))};
