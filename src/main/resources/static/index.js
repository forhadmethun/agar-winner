(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))l(t);new MutationObserver(t=>{for(const n of t)if(n.type==="childList")for(const d of n.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&l(d)}).observe(document,{childList:!0,subtree:!0});function i(t){const n={};return t.integrity&&(n.integrity=t.integrity),t.referrerPolicy&&(n.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?n.credentials="include":t.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function l(t){if(t.ep)return;t.ep=!0;const n=i(t);fetch(t.href,n)}})();let y=$(window).height(),p=$(window).width(),o={},u=[],f=[],s=document.querySelector("#game-board"),r=s.getContext("2d");s.width=p;s.height=y;const h=["#171717","#2E2E2E","#454545","#5C5C5C","#737373","#8A8A8A","#5B7586","#8CA2B0","#36454F","#BF181D","#ED7377","#B35F00","#000080","#38B261","#96DEAE","#E3AE09","#FADB7C","#635345","#BEAEA1","#362624","#212121","#383838","#B7D100","#E5FF2E","#168900","#ADFF9E","#D100D1","#999999","#6B6B6B","#DEDEDE","#B0B0B0","#E4AD58","#DD9A30","#F1D4A7","#483C32","#AB9786","#7E6958","#B75CFF","#A32EFF","#5C6380","#DCDEE6","#8C8C8C","#A52217","#EE8D85","#EAE000","#BCB400","#FFFDD0","#E0B0FF","#D40032","#FF8DA7","#ED4002","#197D4B","#93E9BE","#024376"];s.style.backgroundColor=h[Math.floor(Math.random()*h.length)];$(window).on("load",function(){$("#game-start").modal("show")});$(".name-form").submit(e=>{e.preventDefault(),o.name=document.querySelector("#name-input").value,$("#game-start").modal("hide"),$(".modal").modal("hide"),$(".hiddenOnStart").removeAttr("hidden"),P()});$("#play-again").click(e=>{e.preventDefault(),window.location.reload()});function m(){A(),E(),D(),w(),b(),B(),requestAnimationFrame(m)}function E(){r.clearRect(0,0,s.width,s.height)}function D(){const e=-o.locX+s.width/2,a=-o.locY+s.height/2;r.translate(e,a)}function w(){r.beginPath(),r.fillStyle=o.color,r.arc(o.locX,o.locY,o.radius,0,Math.PI*2),r.fill(),r.lineWidth=3,r.strokeStyle="rgb(0,255,0)",r.stroke(),g(o)}function g(e){var a;for(let i=0;i<((a=e.path)==null?void 0:a.length);i++)r.beginPath(),r.fillStyle=e.color,r.arc(e.path[i][0],e.path[i][1],e.radius/2,0,Math.PI*2),r.fill(),r.lineWidth=3,r.strokeStyle="rgb(0,255,0)",r.stroke()}function b(){u.filter(e=>e.uid!==o.uid).forEach(e=>{r.beginPath(),r.fillStyle=e.color,r.arc(e.locX,e.locY,e.radius,0,Math.PI*2),r.fill(),r.lineWidth=3,r.strokeStyle="rgb(0,255,0)",r.stroke(),g(e)})}function B(){f.forEach(e=>{r.beginPath(),r.fillStyle=e.color,r.arc(e.locX,e.locY,e.radius,0,Math.PI*2),r.fill()})}function F(){$(".player-score").text(o.score||0)}function S(){$(".leader-board").empty(),u.sort((e,a)=>a.score-e.score).forEach(e=>{const a=$('<li class="leaderboard-player">').text(`${e.playerName}: ${e.score}`);$(".leader-board").append(a)})}function A(){r.setTransform(1,0,0,1,0,0)}s.addEventListener("mousemove",e=>{const a={x:e.clientX,y:e.clientY};let i,l;const t=Math.atan2(a.y-s.height/2,a.x-s.width/2)*180/Math.PI;t>=0&&t<90?(i=1-t/90,l=-(t/90)):t>=90&&t<=180?(i=-(t-90)/90,l=-(1-(t-90)/90)):t>=-180&&t<-90?(i=(t+90)/90,l=1+(t+90)/90):t<0&&t>=-90&&(i=(t+90)/90,l=1-(t+90)/90),o.xVector=i,o.yVector=l});const c=new WebSocket("ws://5.135.186.53:8090/ws");function P(){m();const e=C();o={...o,sid:e},c.send(JSON.stringify({_type:"InitMessage",data:{playerName:o.name,sid:e}}))}function C(){return Date.now().toString(36)+Math.random().toString(36).substring(2)}c.addEventListener("message",e=>{const a=JSON.parse(e.data);switch(a&&a._type){case"InitMessageResponse":f=a.data.orbs,o.sid===a.data.playerData.sid&&(o={...o,...a.data.playerData},setInterval(()=>{c.readyState===WebSocket.OPEN&&o.uid&&o.xVector&&c.send(JSON.stringify({_type:"TickMessage",data:{uid:o.uid,xVector:o.xVector||0,yVector:o.yVector||0}}))},33));break;case"PlayerListMessageResponse":u=a.data,S();break;case"TickMessageResponse":o.sid===a.data.playerData.sid&&(o={...o,...a.data.playerData},f=a.data.orbs,F());break}});c.onclose=function(e){o.sid&&($("#game-start").modal("hide"),$("#game-over").modal("show"))};
